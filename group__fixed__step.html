<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=9"/>
		<meta name="generator" content="Doxygen 1.9.2"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		<title>Helpful Stan Functions: Explicit fixed-step methods</title>
		<link href="tabs.css" rel="stylesheet" type="text/css"/>
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="dynsections.js"></script>
		<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
		<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
		<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
		<link href="doxygen.css" rel="stylesheet" type="text/css" />
		<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<link href="prism.css" rel="stylesheet" type="text/css"/>
		<link rel="stylesheet" href="sean-theme.css">
		<script src="highlight.min.js"></script>
		<script>
	$(function() {
		hljs.configure({useBR: false});
	$(".fragment").each(function(i,node) {
		$(node).removeClass("fragment");
		  hljs.highlightAll(node);
	});
});
	</script>
	</head>
	<body>
	<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
		<div id="titlearea">
			<table cellspacing="0" cellpadding="0">
				<tbody>
					<tr style="height: 56px;">
						<td id="projectlogo"><img alt="Logo" src="helpful_logo2_crop.png"/></td>
						<td id="projectalign" style="padding-left: 0.5em;">
							<div id="projectname">Helpful Stan Functions
							</div>
						</td>
					</tr>
				</tbody>
			</table>
		</div>
		<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__fixed__step.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Explicit fixed-step methods<div class="ingroups"><a class="el" href="group__odeint.html">ODE solvers</a></div></div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gae4c015b4a7ba0adf3040bdbfe8170a29"><td class="memItemLeft" align="right" valign="top">array[] vector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fixed__step.html#gae4c015b4a7ba0adf3040bdbfe8170a29">odeint_euler</a> (real t0, vector y0, data real h, data int num_steps, array[] int a0, vector theta)</td></tr>
<tr class="separator:gae4c015b4a7ba0adf3040bdbfe8170a29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga676cf08baaa778445b8c1642e4f31535"><td class="memItemLeft" align="right" valign="top">array[] vector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fixed__step.html#ga676cf08baaa778445b8c1642e4f31535">odeint_midpoint</a> (real t0, vector y0, data real h, data int num_steps, array[] int a0, vector theta)</td></tr>
<tr class="separator:ga676cf08baaa778445b8c1642e4f31535"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac62e1c8e21449a30cfe5ce6988958936"><td class="memItemLeft" align="right" valign="top">array[] vector&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__fixed__step.html#gac62e1c8e21449a30cfe5ce6988958936">odeint_rk4</a> (real t0, vector y0, data real h, data int num_steps, array[] int a0, vector theta)</td></tr>
<tr class="separator:gac62e1c8e21449a30cfe5ce6988958936"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p >These are explicit fixed-step ODE integrators, which evaluate the solution at an equispaced grid of time points. Interpolation can then be used to get the solution at other desired output time points. The functions assume that <code>derivative_fun()</code>, which is the system function of the ODE, is defined earlier in the functions block. It must have signature</p>
<p ><code>vector derivative_fun(real t, vector y, int[] a0, vector a1)</code></p>
<p >i.e. same as what can be used with the <a href="https://mc-stan.org/docs/2_26/stan-users-guide/coding-the-ode-system-function.html">built-in ODE solvers</a> of Stan.</p>
<div class="fragment"><div class="line"> </div>
<div class="line">array[] vector <a class="code hl_function" href="group__fixed__step.html#gae4c015b4a7ba0adf3040bdbfe8170a29">odeint_euler</a>(real t0, vector y0, data real h,</div>
<div class="line">                            data <span class="keywordtype">int</span> num_steps, array[] <span class="keywordtype">int</span> a0, vector theta) {</div>
<div class="line">  <span class="keywordtype">int</span> d = num_elements(y0);</div>
<div class="line">  array[num_steps + 1] vector[d] y;</div>
<div class="line">  real t = t0;</div>
<div class="line">  y[1] = y0;</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Integrate at grid of time points</span></div>
<div class="line">  <span class="keywordflow">for</span> (i in 1 : num_steps) {</div>
<div class="line">    y[i + 1] = y[i] + h * derivative_fun(t, y[i], a0, theta);</div>
<div class="line">    t = t + h;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> y;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="ttc" id="agroup__fixed__step_html_gae4c015b4a7ba0adf3040bdbfe8170a29"><div class="ttname"><a href="group__fixed__step.html#gae4c015b4a7ba0adf3040bdbfe8170a29">odeint_euler</a></div><div class="ttdeci">array[] vector odeint_euler(real t0, vector y0, data real h, data int num_steps, array[] int a0, vector theta)</div><div class="ttdef"><b>Definition:</b> odeint_euler.stanfunctions:40</div></div>
</div><!-- fragment --><div class="fragment"><div class="line"> </div>
<div class="line">array[] vector <a class="code hl_function" href="group__fixed__step.html#ga676cf08baaa778445b8c1642e4f31535">odeint_midpoint</a>(real t0, vector y0, data real h,</div>
<div class="line">                               data <span class="keywordtype">int</span> num_steps, array[] <span class="keywordtype">int</span> a0,</div>
<div class="line">                               vector theta) {</div>
<div class="line">  <span class="keywordtype">int</span> d = num_elements(y0);</div>
<div class="line">  array[num_steps + 1] vector[d] y;</div>
<div class="line">  vector[d] y_mid;</div>
<div class="line">  real t = t0;</div>
<div class="line">  y[1] = y0;</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Integrate at grid of time points</span></div>
<div class="line">  <span class="keywordflow">for</span> (i in 1 : num_steps) {</div>
<div class="line">    <span class="comment">// Half-Euler step</span></div>
<div class="line">    y_mid = y[i] + 0.5 * h * derivative_fun(t, y[i], a0, theta);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Full step using derivative at midpoint</span></div>
<div class="line">    y[i + 1] = y[i] + h * derivative_fun(t + 0.5 * h, y_mid, a0, theta);</div>
<div class="line">    t = t + h;</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">return</span> y;</div>
<div class="line">}</div>
<div class="ttc" id="agroup__fixed__step_html_ga676cf08baaa778445b8c1642e4f31535"><div class="ttname"><a href="group__fixed__step.html#ga676cf08baaa778445b8c1642e4f31535">odeint_midpoint</a></div><div class="ttdeci">array[] vector odeint_midpoint(real t0, vector y0, data real h, data int num_steps, array[] int a0, vector theta)</div><div class="ttdef"><b>Definition:</b> odeint_midpoint.stanfunctions:22</div></div>
</div><!-- fragment --><div class="fragment"><div class="line"> </div>
<div class="line">array[] vector <a class="code hl_function" href="group__fixed__step.html#gac62e1c8e21449a30cfe5ce6988958936">odeint_rk4</a>(real t0, vector y0, data real h,</div>
<div class="line">                          data <span class="keywordtype">int</span> num_steps, array[] <span class="keywordtype">int</span> a0, vector theta) {</div>
<div class="line">  <span class="keywordtype">int</span> d = num_elements(y0);</div>
<div class="line">  array[num_steps + 1] vector[d] y;</div>
<div class="line">  vector[d] k1;</div>
<div class="line">  vector[d] k2;</div>
<div class="line">  vector[d] k3;</div>
<div class="line">  vector[d] k4;</div>
<div class="line">  real t = t0;</div>
<div class="line">  y[1] = y0;</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Integrate at grid of time points</span></div>
<div class="line">  <span class="keywordflow">for</span> (i in 1 : num_steps) {</div>
<div class="line">    k1 = h * derivative_fun(t, y[i], a0, theta);</div>
<div class="line">    k2 = h * derivative_fun(t + 0.5 * h, y[i] + 0.5 * k1, a0, theta);</div>
<div class="line">    k3 = h * derivative_fun(t + 0.5 * h, y[i] + 0.5 * k2, a0, theta);</div>
<div class="line">    k4 = h * derivative_fun(t + h, y[i] + k3, a0, theta);</div>
<div class="line">    y[i + 1] = y[i] + (k1 + 2.0 * k2 + 2.0 * k3 + k4) / 6.0;</div>
<div class="line">    t = t + h;</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">return</span> y;</div>
<div class="line">}</div>
<div class="ttc" id="agroup__fixed__step_html_gac62e1c8e21449a30cfe5ce6988958936"><div class="ttname"><a href="group__fixed__step.html#gac62e1c8e21449a30cfe5ce6988958936">odeint_rk4</a></div><div class="ttdeci">array[] vector odeint_rk4(real t0, vector y0, data real h, data int num_steps, array[] int a0, vector theta)</div><div class="ttdef"><b>Definition:</b> odeint_rk4.stanfunctions:22</div></div>
</div><!-- fragment --> <h2 class="groupheader">Function Documentation</h2>
<a id="gae4c015b4a7ba0adf3040bdbfe8170a29" name="gae4c015b4a7ba0adf3040bdbfe8170a29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae4c015b4a7ba0adf3040bdbfe8170a29">&#9670;&nbsp;</a></span>odeint_euler()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">array[] vector odeint_euler </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>t0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&#160;</td>
          <td class="paramname"><em>y0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">data real&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">data int&#160;</td>
          <td class="paramname"><em>num_steps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array[]int&#160;</td>
          <td class="paramname"><em>a0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&#160;</td>
          <td class="paramname"><em>theta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p ><b>Forward Euler method</b></p>
<p >Info: <a href="https://en.wikipedia.org/wiki/Euler_method">https://en.wikipedia.org/wiki/Euler_method</a> </p><dl class="section author"><dt>Author</dt><dd>Juho Timonen</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t0</td><td>initial time </td></tr>
    <tr><td class="paramname">y0</td><td>initial state, D-vector </td></tr>
    <tr><td class="paramname">h</td><td>step size (positive) </td></tr>
    <tr><td class="paramname">num_steps</td><td>number of steps to take </td></tr>
    <tr><td class="paramname">a0</td><td>array of integer inputs given to <code>derivative_fun()</code> </td></tr>
    <tr><td class="paramname">theta</td><td>parameter vector given to <code>derivative_fun()</code> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array of D-vectors, length equal to <code>num_steps + 1</code> </dd></dl>

</div>
</div>
<a id="ga676cf08baaa778445b8c1642e4f31535" name="ga676cf08baaa778445b8c1642e4f31535"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga676cf08baaa778445b8c1642e4f31535">&#9670;&nbsp;</a></span>odeint_midpoint()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">array[] vector odeint_midpoint </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>t0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&#160;</td>
          <td class="paramname"><em>y0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">data real&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">data int&#160;</td>
          <td class="paramname"><em>num_steps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array[]int&#160;</td>
          <td class="paramname"><em>a0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&#160;</td>
          <td class="paramname"><em>theta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p ><b>Explicit midpoint method</b></p>
<p >Info: <a href="https://en.wikipedia.org/wiki/Midpoint_method">https://en.wikipedia.org/wiki/Midpoint_method</a> </p><dl class="section author"><dt>Author</dt><dd>Juho Timonen</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t0</td><td>initial time </td></tr>
    <tr><td class="paramname">y0</td><td>initial state, D-vector </td></tr>
    <tr><td class="paramname">h</td><td>step size (positive) </td></tr>
    <tr><td class="paramname">num_steps</td><td>number of steps to take </td></tr>
    <tr><td class="paramname">a0</td><td>array of integer inputs given to <code>derivative_fun()</code> </td></tr>
    <tr><td class="paramname">theta</td><td>parameter vector given to <code>derivative_fun()</code> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array of D-vectors, length equal to <code>num_steps + 1</code> </dd></dl>

</div>
</div>
<a id="gac62e1c8e21449a30cfe5ce6988958936" name="gac62e1c8e21449a30cfe5ce6988958936"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac62e1c8e21449a30cfe5ce6988958936">&#9670;&nbsp;</a></span>odeint_rk4()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">array[] vector odeint_rk4 </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>t0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&#160;</td>
          <td class="paramname"><em>y0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">data real&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">data int&#160;</td>
          <td class="paramname"><em>num_steps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array[]int&#160;</td>
          <td class="paramname"><em>a0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&#160;</td>
          <td class="paramname"><em>theta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p ><b>Fourth-order Runge-Kutta method</b></p>
<p >Info: <a href="https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods">https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods</a> </p><dl class="section author"><dt>Author</dt><dd>Juho Timonen</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t0</td><td>initial time </td></tr>
    <tr><td class="paramname">y0</td><td>initial state, D-vector </td></tr>
    <tr><td class="paramname">h</td><td>step size (positive) </td></tr>
    <tr><td class="paramname">num_steps</td><td>number of steps to take </td></tr>
    <tr><td class="paramname">a0</td><td>array of integer inputs given to <code>derivative_fun()</code> </td></tr>
    <tr><td class="paramname">theta</td><td>parameter vector given to <code>derivative_fun()</code> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array of D-vectors, length equal to <code>num_steps + 1</code> </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
<script type="text/javascript">
  $(function() {
     toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
     toggleButton.title = "Toggle Light/Dark Mode"
     $(document).ready(function(){
       document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
     })
     $(window).resize(function(){
       document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
     })
   })
</script>
</body>
</html>